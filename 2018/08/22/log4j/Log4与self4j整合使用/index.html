<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">



  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2" rel="stylesheet">







<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=" rel="stylesheet" type="text/css" />









  <meta name="keywords" content="log4j,self4j," />





  <link rel="alternate" href="/atom.xml" title="JT" type="application/atom+xml" />






<meta name="description" content="之前项目开发过程中，遇到线上问题时运维找不到具体的日志文件，然后把锅丢给了开发组，对于开发来说，日志是自己记录的，所以找起来容易，但对于运维却很困难，于是开始反思是不是我们的日志打得太low了，在网上看了许多的博文，发现这篇博文java日志框架log4j详细配置及与slf4j联合使用教程写得很不错，于是做了借鉴总结。 日志在系统开发的过程中扮演着不可替代的角色，对于开发人员来说，好的日志处理和好的">
<meta name="keywords" content="log4j,self4j">
<meta property="og:type" content="article">
<meta property="og:title" content="Log4与self4j整合使用">
<meta property="og:url" content="http://yoursite.com/2018/08/22/log4j/Log4与self4j整合使用/index.html">
<meta property="og:site_name" content="JT">
<meta property="og:description" content="之前项目开发过程中，遇到线上问题时运维找不到具体的日志文件，然后把锅丢给了开发组，对于开发来说，日志是自己记录的，所以找起来容易，但对于运维却很困难，于是开始反思是不是我们的日志打得太low了，在网上看了许多的博文，发现这篇博文java日志框架log4j详细配置及与slf4j联合使用教程写得很不错，于是做了借鉴总结。 日志在系统开发的过程中扮演着不可替代的角色，对于开发人员来说，好的日志处理和好的">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/3233445-a8d1fc5c88eed7ae.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:updated_time" content="2018-08-22T08:51:50.985Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Log4与self4j整合使用">
<meta name="twitter:description" content="之前项目开发过程中，遇到线上问题时运维找不到具体的日志文件，然后把锅丢给了开发组，对于开发来说，日志是自己记录的，所以找起来容易，但对于运维却很困难，于是开始反思是不是我们的日志打得太low了，在网上看了许多的博文，发现这篇博文java日志框架log4j详细配置及与slf4j联合使用教程写得很不错，于是做了借鉴总结。 日志在系统开发的过程中扮演着不可替代的角色，对于开发人员来说，好的日志处理和好的">
<meta name="twitter:image" content="https://upload-images.jianshu.io/upload_images/3233445-a8d1fc5c88eed7ae.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2018/08/22/log4j/Log4与self4j整合使用/"/>





  <title>Log4与self4j整合使用 | JT</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>
	<a href="https://github.com/Dawn-JT" class="github-corner" aria-label="View source on Github">
	<svg width="80" height="80" viewBox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;"
	aria-hidden="true">
		<path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z">
		</path>
		<path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
		fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm">
		</path>
		<path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
		fill="currentColor" class="octo-body">
		</path>
	</svg>
</a>
<style>
	.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes
	octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media
	(max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner
	.octo-arm{animation:octocat-wave 560ms ease-in-out}}
</style>
    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">JT</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">be an efficient programmer</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
            关于
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/08/22/log4j/Log4与self4j整合使用/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="JT">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/images/head_portrait/dawn.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="JT">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Log4与self4j整合使用</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-08-22T16:39:52+08:00">
                2018-08-22
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/log4j/" itemprop="url" rel="index">
                    <span itemprop="name">log4j</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/log4j/self4j/" itemprop="url" rel="index">
                    <span itemprop="name">self4j</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>之前项目开发过程中，遇到线上问题时运维找不到具体的日志文件，然后把锅丢给了开发组，对于开发来说，日志是自己记录的，所以找起来容易，但对于运维却很困难，于是开始反思是不是我们的日志打得太low了，在网上看了许多的博文，发现这篇博文<a href="https://www.cnblogs.com/ywlaker/p/6124067.html" target="_blank" rel="noopener">java日志框架log4j详细配置及与slf4j联合使用教程</a><br>写得很不错，于是做了借鉴总结。</p>
<p>日志在系统开发的过程中扮演着不可替代的角色，对于开发人员来说，好的日志处理和好的日志习惯有助于后期发现问题，解决问题。对于运维人员来说，日志更是处理线上问题的有利线索和证据，当我们遇到线上服务异常或者线上服务器宕机时，日志的分析变得尤为重要，因此结构清晰，描述清楚日志是每一个开发人员都必须具备能力。</p>
<h5 id="一，概念"><a href="#一，概念" class="headerlink" title="一，概念"></a>一，概念</h5><ul>
<li><p>self4j：按百科来说，SLF4J，即简单日志门面（Simple Logging Facade for Java），不是具体的日志解决方案，它只服务于各种各样的日志系统。实际上，SLF4J所提供的核心API是一些接口以及一个LoggerFactory的工厂类。从某种程度上，SLF4J有点类似JDBC，不过比JDBC更简单，在JDBC中，你需要指定驱动程序，而在使用SLF4J的时候，不需要在代码中或配置文件中指定你打算使用哪个具体的日志系统。如同使用JDBC基本不用考虑具体数据库一样，SLF4J提供了统一的记录日志的接口，只要按照其提供的方法记录即可，最终日志的格式、记录级别、输出方式等通过具体日志系统的配置来实现，因此可以在应用中灵活切换日志系统。</p>
</li>
<li><p>log4j：log4j是Apache的一个开源项目，可以灵活地记录日志信息，我们可以通过Log4j的配置文件灵活配置日志的记录格式、记录级别、输出格式，而不需要修改已有的日志记录代码。</p>
</li>
</ul>
<h5 id="二，log4j基本用法"><a href="#二，log4j基本用法" class="headerlink" title="二，log4j基本用法"></a>二，log4j基本用法</h5><p>首先，如果使用maven构建工程，则只需要引入相应的依赖即可，如果是普通的web工程，则只需要将jar包build path即可。<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.17<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>然后，在src/main/java目录（包的根目录即classpath）新建log4j.properties文件。<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">log4j.<span class="attribute">rootLogger</span>=INFO,console</span><br><span class="line">log4j.additivity.org.<span class="attribute">apache</span>=<span class="literal">true</span></span><br><span class="line"><span class="comment">#console</span></span><br><span class="line">log4j.appender.<span class="attribute">console</span>=org.apache.log4j.ConsoleAppender</span><br><span class="line">log4j.appender.console.<span class="attribute">Threshold</span>=INFO</span><br><span class="line">log4j.appender.console.<span class="attribute">ImmediateFlush</span>=<span class="literal">true</span></span><br><span class="line">log4j.appender.console.<span class="attribute">Target</span>=System.out</span><br><span class="line">log4j.appender.console.<span class="attribute">layout</span>=org.apache.log4j.PatternLayout</span><br><span class="line">log4j.appender.console.layout.<span class="attribute">ConversionPattern</span>=%d&#123;yyyy-MM-dd HH:mm:ss&#125; [%p] %m%n</span><br></pre></td></tr></table></figure></p>
<p>测试类：<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> &#123;</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">new</span> Test().test();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span> &#123;</span></span><br><span class="line">    final Logger <span class="built_in">log</span> = Logger.getLogger(Test.class);</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="built_in">log</span>.info(<span class="string">"this is log.info()"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h5 id="三，log4j-properties路径"><a href="#三，log4j-properties路径" class="headerlink" title="三，log4j.properties路径"></a>三，log4j.properties路径</h5><p>log4j.properties要放在哪以及怎样配置才能被解析呢？不同工程类型配置方式不同。</p>
<h6 id="3-1-普通java或spring工程"><a href="#3-1-普通java或spring工程" class="headerlink" title="3.1 普通java或spring工程"></a>3.1 普通java或spring工程</h6><p>这是最常见的java工程类型，写demo用的多，把log4j.properties放在src/main/java目录（包的根目录）就行了。<br><img src="https://upload-images.jianshu.io/upload_images/3233445-a8d1fc5c88eed7ae.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<h6 id="3-2-spring-mvc工程"><a href="#3-2-spring-mvc工程" class="headerlink" title="3.2 spring mvc工程"></a>3.2 spring mvc工程</h6><p>web工程里用spring mvc构建的比较多了，把log4j.properties放在src/main/resources的conf目录（web工程配置文件通常在resources或WEB-INF目录），编辑web.xml，添加<br><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="params">&lt;context-param&gt;</span></span><br><span class="line">    <span class="params">&lt;param-name&gt;</span>log4jConfigLocation<span class="params">&lt;/param-name&gt;</span></span><br><span class="line">    <span class="params">&lt;param-value&gt;</span>classpath:<span class="meta-keyword">/conf/</span>log4j.properties<span class="params">&lt;/param-value&gt;</span></span><br><span class="line"><span class="params">&lt;/context-param&gt;</span></span><br><span class="line"><span class="params">&lt;listener&gt;</span></span><br><span class="line">    <span class="params">&lt;listener-class&gt;</span>org.springframework.web.util.Log4jConfigListener<span class="params">&lt;/listener-class&gt;</span></span><br><span class="line"><span class="params">&lt;/listener&gt;</span></span><br></pre></td></tr></table></figure></p>
<h6 id="3-3-普通web工程"><a href="#3-3-普通web工程" class="headerlink" title="3.3 普通web工程"></a>3.3 普通web工程</h6><p>没有了spring提供的listener加载log4j.properties，我们要怎么加载这个文件呢？同样，把log4j.properties放在src/main/resources的conf目录，用servlet加载。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Log4jServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(ServletConfig config)</span> <span class="keyword">throws</span> ServletException </span>&#123;</span><br><span class="line">        String prefix = <span class="keyword">this</span>.getClass().getClassLoader().getResource(<span class="string">"/"</span>).getPath();</span><br><span class="line">        String path = config.getInitParameter(<span class="string">"log4j-path"</span>);</span><br><span class="line">        PropertyConfigurator.configure(prefix + path);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse res)</span> <span class="keyword">throws</span> IOException, ServletException </span>&#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse res)</span> <span class="keyword">throws</span> IOException, ServletException </span>&#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>编辑web.xml，添加<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>com.xmyself.log4j.Log4jServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>log4j-path<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>conf/log4j.properties<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span>1<span class="tag">&lt;/<span class="name">load-on-startup</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>看着是不是和spring mvc的很像，甚至你也想到了，普通java工程没有指定log4j.properties的路径，那说明log4j的jar包一定有一个默认的路径。另外，建议，log4j的配置放在第一个，因为后续加载其他组件就要开始使用日志记录了</p>
<p>　　现在，你可以在多种类型的java工程中打出日志了，但都是控制台的日志，输出内容也很有限，下面我们就来详细介绍log4j.properties内容怎么配置。</p>
<h5 id="四，log4j-properties内容"><a href="#四，log4j-properties内容" class="headerlink" title="四，log4j.properties内容"></a>四，log4j.properties内容</h5><p>接下来介绍的内容看起来独立，其实相互关联，并且很有规律，我们要输出日志，首先得有日志对象（logger），那这些日志对象把日志输出到哪里呢，控制台还是文件，这就要设置输出位置（appender），输出的格式与内容又是什么样的呢，这就要设置输出样式（layout），这些设置完，log4j的配置也就完了。</p>
<p>在此之前，先介绍下log4j日志等级的概念，日志等级就是日志的重要程度，log4j日志分为7个等级：ALL、DEBUG、INFO、WARN、ERROR、FATAL、OFF，从左到右等级由低到高，分等级是为了设置日志输出的门槛，只有等级等于或高于这个门槛的日志才有机会输出。</p>
<h6 id="4-1-logger"><a href="#4-1-logger" class="headerlink" title="4.1 logger"></a>4.1 logger</h6><p>日志实例，就是代码里实例化的Logger对象。<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">log4j.<span class="attribute">rootLogger</span>=LEVEL,appenderName1,appenderName2,...</span><br><span class="line">log4j.additivity.org.<span class="attribute">apache</span>=<span class="literal">false</span>：表示不会在父logger的appender里输出，默认true</span><br></pre></td></tr></table></figure></p>
<p>这是全局logger的配置，LEVEL用来设定日志等级，appenderName定义日志输出器，示例中的“console”就是一个日志输出器</p>
<p>　　下面给出一个更清晰的例子，配置“com.demo.test”包下所有类中实例化的Logger对象。<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">log4j<span class="selector-class">.logger</span><span class="selector-class">.com</span><span class="selector-class">.demo</span><span class="selector-class">.test</span>=DEBUG,test</span><br><span class="line">log4j<span class="selector-class">.additivity</span><span class="selector-class">.com</span><span class="selector-class">.demo</span><span class="selector-class">.test</span>=false</span><br></pre></td></tr></table></figure></p>
<h6 id="4-2-appender"><a href="#4-2-appender" class="headerlink" title="4.2 appender"></a>4.2 appender</h6><p>日志输出器，指定logger的输出位置<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">log4j<span class="selector-class">.appender</span><span class="selector-class">.appenderName</span>=className</span><br></pre></td></tr></table></figure></p>
<p>appender有5种选择<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">org<span class="selector-class">.apache</span><span class="selector-class">.log4j</span><span class="selector-class">.ConsoleAppender</span>（控制台）</span><br><span class="line">org<span class="selector-class">.apache</span><span class="selector-class">.log4j</span><span class="selector-class">.FileAppender</span>（文件）</span><br><span class="line">org<span class="selector-class">.apache</span><span class="selector-class">.log4j</span><span class="selector-class">.DailyRollingFileAppender</span>（每天产生一个日志文件）</span><br><span class="line">org<span class="selector-class">.apache</span><span class="selector-class">.log4j</span><span class="selector-class">.RollingFileAppender</span>（文件大小到达指定尺寸的时候产生一个新的文件）</span><br><span class="line">org<span class="selector-class">.apache</span><span class="selector-class">.log4j</span><span class="selector-class">.WriterAppender</span>（将日志信息以流格式发送到任意指定的地方</span><br></pre></td></tr></table></figure></p>
<p>每种appender都有若干配置项，下面逐一介绍</p>
<p>ConsoleAppender（常用）<br><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">Threshold</span>=WARN：指定日志信息的最低输出级别，默认DEBUG</span><br><span class="line"><span class="attr">ImmediateFlush</span>=<span class="literal">true</span>：表示所有消息都会被立即输出，设为<span class="literal">false</span>则不输出，默认值是<span class="literal">true</span></span><br><span class="line"><span class="attr">Target</span>=System.err：默认值是System.out</span><br></pre></td></tr></table></figure></p>
<p>FileAppender<br><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">Threshold</span>=WARN：指定日志信息的最低输出级别，默认DEBUG</span><br><span class="line"><span class="attr">ImmediateFlush</span>=<span class="literal">true</span>：表示所有消息都会被立即输出，设为<span class="literal">false</span>则不输出，默认<span class="literal">true</span></span><br><span class="line"><span class="attr">Append</span>=<span class="literal">false</span>：<span class="literal">true</span>表示消息增加到指定文件中，<span class="literal">false</span>则将消息覆盖指定的文件内容，默认<span class="literal">true</span></span><br><span class="line"><span class="attr">File</span>=D:/logs/logging.log4j：指定消息输出到logging.log4j文件</span><br></pre></td></tr></table></figure></p>
<p>DailyRollingFileAppender（常用）<br><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">hreshold=WARN：指定日志信息的最低输出级别，默认DEBUG</span><br><span class="line">ImmediateFlush=<span class="keyword">true</span>：表示所有消息都会被立即输出，设为<span class="keyword">false</span>则不输出，默认<span class="keyword">true</span></span><br><span class="line"><span class="keyword">Append</span>=<span class="keyword">false</span>：<span class="keyword">true</span>表示消息增加到指定文件中，<span class="keyword">false</span>则将消息覆盖指定的文件内容，默认<span class="keyword">true</span></span><br><span class="line"><span class="keyword">File</span>=D:<span class="regexp">/logs/</span>logging.log4j：指定当前消息输出到logging.log4j文件</span><br><span class="line">DatePattern=<span class="string">'.'</span>yyyy-MM：每月滚动一次日志文件，即每月产生一个新的日志文件。当前月的日志文件名为logging.log4j，前一个月的日志文件名为logging.log4j.yyyy-MM</span><br><span class="line">另外，也可以指定按周、天、时、分等来滚动日志文件，对应的格式如下：</span><br><span class="line"><span class="number">1</span>)<span class="string">'.'</span>yyyy-MM：每月</span><br><span class="line"><span class="number">2</span>)<span class="string">'.'</span>yyyy-ww：每周</span><br><span class="line"><span class="number">3</span>)<span class="string">'.'</span>yyyy-MM-dd：每天</span><br><span class="line"><span class="number">4</span>)<span class="string">'.'</span>yyyy-MM-dd-a：每天两次</span><br><span class="line"><span class="number">5</span>)<span class="string">'.'</span>yyyy-MM-dd-HH：每小时</span><br><span class="line"><span class="number">6</span>)<span class="string">'.'</span>yyyy-MM-dd-HH-mm：每分钟</span><br></pre></td></tr></table></figure></p>
<p>RollingFileAppender<br><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">Threshold</span>=WARN：指定日志信息的最低输出级别，默认DEBUG</span><br><span class="line"><span class="attr">ImmediateFlush</span>=<span class="literal">true</span>：表示所有消息都会被立即输出，设为<span class="literal">false</span>则不输出，默认<span class="literal">true</span></span><br><span class="line"><span class="attr">Append</span>=<span class="literal">false</span>：<span class="literal">true</span>表示消息增加到指定文件中，<span class="literal">false</span>则将消息覆盖指定的文件内容，默认<span class="literal">true</span></span><br><span class="line"><span class="attr">File</span>=D:/logs/logging.log4j：指定消息输出到logging.log4j文件</span><br><span class="line"><span class="attr">MaxFileSize</span>=<span class="number">100</span>KB：后缀可以是KB,MB或者GB。在日志文件到达该大小时，将会自动滚动，即将原来的内容移到logging.log4j.<span class="number">1</span>文件</span><br><span class="line"><span class="attr">MaxBackupIndex</span>=<span class="number">2</span>：指定可以产生的滚动文件的最大数，例如，设为<span class="number">2</span>则可以产生logging.log4j.<span class="number">1</span>，logging.log4j.<span class="number">2</span>两个滚动文件和一个logging.log4j文件</span><br></pre></td></tr></table></figure></p>
<h6 id="4-3-layout"><a href="#4-3-layout" class="headerlink" title="4.3 layout"></a>4.3 layout</h6><p>指定logger输出内容及格式。<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">log4j<span class="selector-class">.appender</span><span class="selector-class">.appenderName</span><span class="selector-class">.layout</span>=className</span><br></pre></td></tr></table></figure></p>
<p>layout有4种选择。<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">org<span class="selector-class">.apache</span><span class="selector-class">.log4j</span><span class="selector-class">.HTMLLayout</span>（以HTML表格形式布局）</span><br><span class="line">org<span class="selector-class">.apache</span><span class="selector-class">.log4j</span><span class="selector-class">.PatternLayout</span>（可以灵活地指定布局模式）</span><br><span class="line">org<span class="selector-class">.apache</span><span class="selector-class">.log4j</span><span class="selector-class">.SimpleLayout</span>（包含日志信息的级别和信息字符串）</span><br><span class="line">org<span class="selector-class">.apache</span><span class="selector-class">.log4j</span><span class="selector-class">.TTCCLayout</span>（包含日志产生的时间、线程、类别等信息）</span><br></pre></td></tr></table></figure></p>
<p>layout也有配置项，下面具体介绍</p>
<p>HTMLLayout<br><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">LocationInfo</span>=<span class="literal">true</span>：输出java文件名称和行号，默认<span class="literal">false</span></span><br><span class="line"><span class="attr">Title</span>=My Logging： 默认值是Log4J Log Messages</span><br></pre></td></tr></table></figure></p>
<p>PatternLayout（最常用的配置）<br> <figure class="highlight cos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ConversionPattern=<span class="built_in">%m</span><span class="built_in">%n</span>：设定以怎样的格式显示消息</span><br></pre></td></tr></table></figure></p>
<p>设置格式的参数说明如下<br><figure class="highlight mojolicious"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"></span><span class="perl">%p：输出日志信息的优先级，即DEBUG，INFO，WARN，ERROR，FATAL</span><span class="xml"></span></span><br><span class="line"><span class="xml"></span><span class="perl">%d：输出日志时间点的日期或时间，默认格式为ISO8601，可以指定格式如：%d&#123;yyyy/MM/dd HH:mm:ss,SSS&#125;</span><span class="xml"></span></span><br><span class="line"><span class="xml"></span><span class="perl">%r：输出自应用程序启动到输出该<span class="keyword">log</span>信息耗费的毫秒数</span><span class="xml"></span></span><br><span class="line"><span class="xml"></span><span class="perl">%t：输出产生该日志事件的线程名</span><span class="xml"></span></span><br><span class="line"><span class="xml"></span><span class="perl">%l：输出日志事件的发生位置，相当于%c.%M(%F:%L)的组合，包括类全名、方法、文件名以及在代码中的行数</span><span class="xml"></span></span><br><span class="line"><span class="xml"></span><span class="perl">%c：输出日志信息所属的类目，通常就是类全名</span><span class="xml"></span></span><br><span class="line"><span class="xml"></span><span class="perl">%M：输出产生日志信息的方法名</span><span class="xml"></span></span><br><span class="line"><span class="xml"></span><span class="perl">%F：输出日志消息产生时所在的文件名</span><span class="xml"></span></span><br><span class="line"><span class="xml"></span><span class="perl">%L：输出代码中的行号</span><span class="xml"></span></span><br><span class="line"><span class="xml"></span><span class="perl">%m：输出代码中指定的具体日志信息</span><span class="xml"></span></span><br><span class="line"><span class="xml"></span><span class="perl">%n：输出一个回车换行符，Windows平台为<span class="string">"rn"</span>，Unix平台为<span class="string">"n"</span></span><span class="xml"></span></span><br><span class="line"><span class="xml"></span><span class="perl">%x：输出和当前线程相关联的NDC(嵌套诊断环境)</span><span class="xml"></span></span><br><span class="line"><span class="xml"></span><span class="perl">%%：输出一个<span class="string">"%"字符</span></span><span class="xml"></span></span><br></pre></td></tr></table></figure></p>
<h5 id="五，log4j完整配置示例"><a href="#五，log4j完整配置示例" class="headerlink" title="五，log4j完整配置示例"></a>五，log4j完整配置示例</h5><p>介绍完了log4j.properties内容，我们来配置一些常用的日志输出吧<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">log4j.<span class="attribute">rootLogger</span>=DEBUG,console,dailyFile,rollingFile,logFile</span><br><span class="line">log4j.additivity.org.<span class="attribute">apache</span>=<span class="literal">true</span></span><br></pre></td></tr></table></figure></p>
<p>控制台console日志输出器<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 控制台(console)</span></span><br><span class="line">log4j.appender.<span class="attribute">console</span>=org.apache.log4j.ConsoleAppender</span><br><span class="line">log4j.appender.console.<span class="attribute">Threshold</span>=DEBUG</span><br><span class="line">log4j.appender.console.<span class="attribute">ImmediateFlush</span>=<span class="literal">true</span></span><br><span class="line">log4j.appender.console.<span class="attribute">Target</span>=System.err</span><br><span class="line">log4j.appender.console.<span class="attribute">layout</span>=org.apache.log4j.PatternLayout</span><br><span class="line">log4j.appender.console.layout.<span class="attribute">ConversionPattern</span>=%d&#123;yyyy-MM-dd HH:mm:ss&#125; [%p] %m%n</span><br></pre></td></tr></table></figure></p>
<p>文件logFile日志输出器<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 日志文件(logFile)</span></span><br><span class="line">log4j.appender.<span class="attribute">logFile</span>=org.apache.log4j.FileAppender</span><br><span class="line">log4j.appender.logFile.<span class="attribute">Threshold</span>=DEBUG</span><br><span class="line">log4j.appender.logFile.<span class="attribute">ImmediateFlush</span>=<span class="literal">true</span></span><br><span class="line">log4j.appender.logFile.<span class="attribute">Append</span>=<span class="literal">true</span></span><br><span class="line">log4j.appender.logFile.<span class="attribute">File</span>=D:/logs/log.log4j</span><br><span class="line">log4j.appender.logFile.<span class="attribute">layout</span>=org.apache.log4j.PatternLayout</span><br><span class="line">log4j.appender.logFile.layout.<span class="attribute">ConversionPattern</span>=%d&#123;yyyy-MM-dd HH:mm:ss&#125; [%p] %m%n</span><br></pre></td></tr></table></figure></p>
<p>滚动文件rollingFile日志输出器<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 滚动文件(rollingFile)</span></span><br><span class="line">log4j.appender.<span class="attribute">rollingFile</span>=org.apache.log4j.RollingFileAppender</span><br><span class="line">log4j.appender.rollingFile.<span class="attribute">Threshold</span>=DEBUG</span><br><span class="line">log4j.appender.rollingFile.<span class="attribute">ImmediateFlush</span>=<span class="literal">true</span></span><br><span class="line">log4j.appender.rollingFile.<span class="attribute">Append</span>=<span class="literal">true</span></span><br><span class="line">log4j.appender.rollingFile.<span class="attribute">File</span>=D:/logs/log.log4j</span><br><span class="line">log4j.appender.rollingFile.<span class="attribute">MaxFileSize</span>=200KB</span><br><span class="line">log4j.appender.rollingFile.<span class="attribute">MaxBackupIndex</span>=50</span><br><span class="line">log4j.appender.rollingFile.<span class="attribute">layout</span>=org.apache.log4j.PatternLayout</span><br><span class="line">log4j.appender.rollingFile.layout.<span class="attribute">ConversionPattern</span>=%d&#123;yyyy-MM-dd HH:mm:ss&#125; [%p] %m%n</span><br></pre></td></tr></table></figure></p>
<p>定期滚动文件dailyFile日志输出器<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 定期滚动日志文件(dailyFile)</span></span><br><span class="line">log4j.appender.<span class="attribute">dailyFile</span>=org.apache.log4j.DailyRollingFileAppender</span><br><span class="line">log4j.appender.dailyFile.<span class="attribute">Threshold</span>=DEBUG</span><br><span class="line">log4j.appender.dailyFile.<span class="attribute">ImmediateFlush</span>=<span class="literal">true</span></span><br><span class="line">log4j.appender.dailyFile.<span class="attribute">Append</span>=<span class="literal">true</span></span><br><span class="line">log4j.appender.dailyFile.<span class="attribute">File</span>=D:/logs/log.log4j</span><br><span class="line">log4j.appender.dailyFile.<span class="attribute">DatePattern</span>=<span class="string">'.'</span>yyyy-MM-dd</span><br><span class="line">log4j.appender.dailyFile.<span class="attribute">layout</span>=org.apache.log4j.PatternLayout</span><br><span class="line">log4j.appender.dailyFile.layout.<span class="attribute">ConversionPattern</span>=%d&#123;yyyy-MM-dd HH:mm:ss&#125; [%p] %m%n</span><br></pre></td></tr></table></figure></p>
<h5 id="六，log4j局部日志配置"><a href="#六，log4j局部日志配置" class="headerlink" title="六，log4j局部日志配置"></a>六，log4j局部日志配置</h5><p>　以上介绍的配置都是全局的，整个工程的代码使用同一套配置，意味着所有的日志都输出在了相同的地方，你无法直接了当的去看数据库访问日志、用户登录日志、操作日志，它们都混在一起，因此，需要为包甚至是类配置单独的日志输出，下面给出一个例子，为“com.demo.test”包指定日志输出器“test”，“com.demo.test”包下所有类的日志都将输出到/log/test.log文件。<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">log4j.logger.com.demo.<span class="attribute">test</span>=DEBUG,test</span><br><span class="line">log4j.appender.<span class="attribute">test</span>=org.apache.log4j.FileAppender</span><br><span class="line">log4j.appender.test.<span class="attribute">File</span>=/log/test.log</span><br><span class="line">log4j.appender.test.<span class="attribute">layout</span>=org.apache.log4j.PatternLayout</span><br><span class="line">log4j.appender.test.layout.<span class="attribute">ConversionPattern</span>=%d&#123;yyyy-MM-dd HH:mm:ss&#125; [%p] %m%n</span><br></pre></td></tr></table></figure></p>
<p>也可以让同一个类输出不同的日志，为达到这个目的，需要在这个类中实例化两个logger。<br><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> Log logger1 = LogFactory.getLog(<span class="string">"myTest1"</span>);</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> Log logger2 = LogFactory.getLog(<span class="string">"myTest2"</span>);</span><br></pre></td></tr></table></figure></p>
<p>然后分别配置<br><figure class="highlight roboconf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">log4j.logger.myTest1= DEBUG,test1</span><br><span class="line">log4j.additivity.myTest1=false</span><br><span class="line">log4j.appender.test1=org.apache.log4j.FileAppender</span><br><span class="line">log4j.appender.test1.File=/log/test1.log</span><br><span class="line">log4j.appender.test1.layout=org.apache.log4j.PatternLayout</span><br><span class="line">log4j.appender.test1.layout.ConversionPattern=%d&#123;<span class="attribute">yyyy-MM-dd HH</span>:mm:ss&#125; [%p] %m%n</span><br><span class="line">  </span><br><span class="line">log4j<span class="variable">.logger</span><span class="variable">.myTest</span>2=DEBUG,test2</span><br><span class="line">log4j<span class="variable">.appender</span><span class="variable">.test</span>2=org<span class="variable">.apache</span><span class="variable">.log</span>4j<span class="variable">.FileAppender</span></span><br><span class="line">log4j<span class="variable">.appender</span><span class="variable">.test</span>2<span class="variable">.File</span>=/log/test2<span class="variable">.log</span></span><br><span class="line">log4j<span class="variable">.appender</span><span class="variable">.test</span>2<span class="variable">.layout</span>=org<span class="variable">.apache</span><span class="variable">.log</span>4j<span class="variable">.PatternLayout</span></span><br><span class="line">log4j<span class="variable">.appender</span><span class="variable">.test</span>2<span class="variable">.layout</span><span class="variable">.ConversionPattern</span>=%d&#123;yyyy-MM-dd HH:mm:ss&#125; [%p] %m%n</span><br></pre></td></tr></table></figure></p>
<h5 id="七，slf4j与log4j联合使用"><a href="#七，slf4j与log4j联合使用" class="headerlink" title="七，slf4j与log4j联合使用"></a>七，slf4j与log4j联合使用</h5><p>slf4j是什么？slf4j只是定义了一组日志接口，但并未提供任何实现，既然这样，为什么要用slf4j呢？log4j不是已经满足要求了吗？</p>
<p>是的，log4j满足了要求，但是，日志框架并不只有log4j一个，你喜欢用log4j，有的人可能更喜欢logback，有的人甚至用jdk自带的日志框架，这种情况下，如果你要依赖别人的jar，整个系统就用了两个日志框架，如果你依赖10个jar，每个jar用的日志框架都不同，岂不是一个工程用了10个日志框架，那就乱了！</p>
<p>如果你的代码使用slf4j的接口，具体日志实现框架你喜欢用log4j，其他人的代码也用slf4j的接口，具体实现未知，那你依赖其他人jar包时，整个工程就只会用到log4j日志框架，这是一种典型的门面模式应用，与jvm思想相同，我们面向slf4j写日志代码，slf4j处理具体日志实现框架之间的差异，正如我们面向jvm写java代码，jvm处理操作系统之间的差异，结果就是，一处编写，到处运行。况且，现在越来越多的开源工具都在用slf4j了</p>
<p>那么，怎么用slf4j呢？</p>
<p>首先，得弄到slf4j的jar包，maven依赖如下，log4j配置过程完全不变。<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.slf4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>slf4j-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.7.21<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>然后，弄到slf4j与log4j的关联jar包，通过这个东西，将对slf4j接口的调用转换为对log4j的调用，不同的日志实现框架，这个转换工具不同<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.slf4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>slf4j-log4j12<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.7.21<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>当然了，slf4j-log4j12这个包肯定依赖了slf4j和log4j，所以使用slf4j+log4j的组合只要配置上面这一个依赖就够了</p>
<p>最后，代码里声明logger要改一下，原来使用log4j是这样的<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.log4j.Logger;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span> &#123;</span></span><br><span class="line">    final Logger <span class="built_in">log</span> = Logger.getLogger(Test.class);</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="built_in">log</span>.info(<span class="string">"hello this is log4j info log"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>现在要改成这样<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.slf4j.Logger;</span><br><span class="line"><span class="keyword">import</span> org.slf4j.LoggerFactory;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span> &#123;</span></span><br><span class="line">    Logger <span class="built_in">log</span> = LoggerFactory.getLogger(Test.class);</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="built_in">log</span>.info(<span class="string">"hello, my name is &#123;&#125;"</span>, <span class="string">"chengyi"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>依赖的Logger变了，而且，slf4j的api还能使用占位符，很方便。</p>
<p>作者：凌承一</p>
<p>出处：<a href="http://www.cnblogs.com/ywlaker/" target="_blank" rel="noopener">http://www.cnblogs.com/ywlaker/</a></p>
<p>声明：本文版权归作者和博客园共有，欢迎转载，但转载必须保留此段声明，并在文章页面明显位置给出原文链接，否则作者将保留追究法律责任的权利。</p>

      
    </div>
    
    
    
	
	<div>
	  
		<div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;">-------------本文结束<i class="fa fa-paw"></i>感谢您的阅读-------------</div>
    
</div>
	  
	</div>
	
    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/log4j/" rel="tag"><i class="fa fa-tag"></i> log4j</a>
          
            <a href="/tags/self4j/" rel="tag"><i class="fa fa-tag"></i> self4j</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/08/21/spring/Spring应用于组件注册的注解/" rel="next" title="Spring应用于组件注册的注解">
                <i class="fa fa-chevron-left"></i> Spring应用于组件注册的注解
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2018/08/23/spring/Spring容器中Bean的生命周期/" rel="prev" title="Spring容器中Bean的生命周期">
                Spring容器中Bean的生命周期 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/uploads/images/head_portrait/dawn.jpg"
                alt="JT" />
            
              <p class="site-author-name" itemprop="name">JT</p>
              <p class="site-description motion-element" itemprop="description">Tomorrow will be better</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives">
              
                  <span class="site-state-item-count">3</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">3</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">3</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/Dawn-JT" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-globe"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://www.jianshu.com/u/8a644e6f06fb" target="_blank" title="简书">
                      
                        <i class="fa fa-fw fa-globe"></i>简书</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://blog.csdn.net/shuduti" target="_blank" title="CSDN">
                      
                        <i class="fa fa-fw fa-globe"></i>CSDN</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-5"><a class="nav-link" href="#一，概念"><span class="nav-number">1.</span> <span class="nav-text">一，概念</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#二，log4j基本用法"><span class="nav-number">2.</span> <span class="nav-text">二，log4j基本用法</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#三，log4j-properties路径"><span class="nav-number">3.</span> <span class="nav-text">三，log4j.properties路径</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#3-1-普通java或spring工程"><span class="nav-number">3.1.</span> <span class="nav-text">3.1 普通java或spring工程</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#3-2-spring-mvc工程"><span class="nav-number">3.2.</span> <span class="nav-text">3.2 spring mvc工程</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#3-3-普通web工程"><span class="nav-number">3.3.</span> <span class="nav-text">3.3 普通web工程</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#四，log4j-properties内容"><span class="nav-number">4.</span> <span class="nav-text">四，log4j.properties内容</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#4-1-logger"><span class="nav-number">4.1.</span> <span class="nav-text">4.1 logger</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#4-2-appender"><span class="nav-number">4.2.</span> <span class="nav-text">4.2 appender</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#4-3-layout"><span class="nav-number">4.3.</span> <span class="nav-text">4.3 layout</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#五，log4j完整配置示例"><span class="nav-number">5.</span> <span class="nav-text">五，log4j完整配置示例</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#六，log4j局部日志配置"><span class="nav-number">6.</span> <span class="nav-text">六，log4j局部日志配置</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#七，slf4j与log4j联合使用"><span class="nav-number">7.</span> <span class="nav-text">七，slf4j与log4j联合使用</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<div class="copyright">&copy; 2017 &mdash; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">JT</span>

  
</div>
<!--

  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v</div>




-->
<div class="powered-by">
	<i class="fa fa-user-md">
	</i>
	<span id="busuanzi_container_site_uv">
		本站访客数:
		<span id="busuanzi_value_site_uv">
		</span>
	</span>
</div>
<div class="theme-info">
	<div class="powered-by">
	</div>
	<span class="post-count">
		博客全站共6.7k字
	</span>
</div>

        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v="></script>

  <script type="text/javascript" src="/js/src/motion.js?v="></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v="></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v="></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v="></script>
<script type="text/javascript" src="/js/src/post-details.js?v="></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v="></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

  
</body>
</html>
<script type="text/javascript" src="/js/src/love.js"></script>